{"version":3,"sources":["../../display/dist/constants/index.js","../../display/dist/utils/index.js","../../display/dist/pitch-display/index.js","components/pitch/index.tsx","constants/colors.js","components/pitch/pitch-monitor.tsx","components/circle-chart/utils.tsx","components/circle-chart/circle-chat.tsx","model.ts","components/side-nav/side-nav.tsx","components/main/options.tsx","components/main/app-frame.tsx","components/main/about.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["NOTE_STRINGS","OCTAVE_COLORS","noteFromPitch","frequency","noteNum","Math","log","round","centsOffFromPitch","note","floor","pow","frequencyFromNoteNumber","colorFromNote","octave","idx","min","length","max","PitchDisplay","constructor","container","timeSpan","arguments","undefined","timeOffset","this","frequencies","background","highlight","style","position","canvasStyle","bgCanvas","document","createElement","setAttribute","bgContext","getContext","noteCanvas","noteContext","appendChild","resize","w","clientWidth","h","clientHeight","width","height","scaleX","scaleLinear","domain","range","margin","scaleY","render","pushFrequency","push","cleanupFrequencies","filter","val","now","time","full","Date","getTime","drawBackground","drawNotes","setBackgroundColor","color","setHighlightColor","fillStyle","clearRect","fillRect","i","y","font","fillText","beginPath","strokeStyle","notes","t","f","c","clarity","centsOff","x","stroke","moveTo","lineTo","concat","arc","PI","fill","PitchComponent","Component","displayElement","React","createRef","pitchDisplay","lastRender","continuousUpdate","onResize","componentDidMount","current","startRender","updatePitch","requestAnimationFrame","window","addEventListener","componentWillUnmount","removeEventListener","freq","props","_jsx","Fragment","children","className","ref","PitchMonitor","_ref","stream","detectorName","workerConnection","windowSize","powerThreshold","clarityThreshold","enabled","pitchRenderer","setFreq","useState","setClarity","pendingRef","useRef","pitchSetupRef","setupConnection","useCallback","async","remoteHandle","call","pitchSetup","buffer","Float32Array","audioContext","AudioContext","mediaStreamSource","createMediaStreamSource","analyser","createAnalyser","fftSize","connect","console","warn","getFloatTimeDomainData","result","sampleRate","useEffect","escape","cancelRender","renderFrame","PitchRenderer","LOG_A","log2","radialBoxLayoutOffsets","angle","r","pi","tan","arctan","atan","sqrt","sin","cos","outx","outy","criticalrange1","criticalrange2","a","b","B","NOTE_SYMBOLS_SHARP","C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","NOTE_SYMBOLS_FLAT","Frequency","_ref3","hz","noteFormat","noteSymbols","Object","keys","logNote","rot","freqToNote","_jsxs","CircleChartBackground","memo","_ref4","canvas","noteRefs","cX","cY","outerR","innerR","_canvas$current","ctx","_options$outerR","_options$innerR","options","ring","Path2D","ticks","tickLen","vecX","vecY","lineWidth","drawCircleChartBackground","div","divW","divH","getBoundingClientRect","ox","oy","left","top","map","CircleChart","_ref5","setW","setH","surroundingDivRef","canvasPointerRef","computeInnerAndOuterRadius","freqToAngle","useLayoutEffect","handleResize","pointerContext","_ref2","opacity","vec_x","vec_y","nvec_x","nvec_y","lineJoin","drawCircleChartArrow","transformOrigin","transform","visibility","store","createStore","displayType","loading","loaded","audioOptions","audio","echoCancellation","autoGainControl","setWindowSize","action","state","payload","setDetectorName","setDisplayType","setClarityThreshold","setEnabled","setStream","setLoading","setLoaded","setWorkerConnection","initializeStream","thunk","actions","getState","navigator","mediaDevices","getUserMedia","e","error","stopStream","track","getTracks","stop","initializeWorker","worker","Worker","process","messenger","WorkerMessenger","connection","ParentHandshake","typedHooks","createTypedHooks","useStoreActions","useStoreState","useStoreDispatch","SideNavContext","createContext","expanded","toggleExpanded","Toggle","useContext","type","onClick","NavItem","rest","_objectWithoutProperties","_excluded","_rest","_excluded2","_objectSpread","NavIcon","NavText","NavExtra","_ref6","SideNav","assign","_expanded","onToggle","setExpanded","Provider","value","Nav","Select","selected","_selected","onSelect","_onSelect","choices","setSelected","selectedIndex","findIndex","item","DropdownButton","index","title","desc","variant","as","Dropdown","Item","eventKey","SelectWindowSize","SelectDetector","SelectClarityThreshold","Form","Group","Control","step","onChange","parseFloat","target","SelectDisplayType","AppFrame","menuExpanded","setMenuExpanded","running","setRunning","Navbar","bg","Brand","Stop","size","Play","Gear","ListGroup","Lightbulb","role","About","textAlign","src","alt","maxWidth","App","mainDisplay","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode","StoreProvider","getElementById"],"mappings":"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","file":"static/js/main.55b143ae.chunk.js","sourcesContent":["export const NOTE_STRINGS = [\"C\", \"D♭\", \"D\", \"E♭\", \"E\", \"F\", \"G♭\", \"G\", \"A♭\", \"A\", \"B♭\", \"B\"];\nexport const OCTAVE_COLORS = [\n    [121, 85, 72],\n    [158, 158, 158],\n    [96, 125, 139],\n    [76, 175, 80],\n    [244, 67, 54],\n    [33, 150, 243],\n    [0, 150, 136],\n    [255, 235, 59],\n    [0, 188, 212],\n];\n","import { OCTAVE_COLORS } from '../constants';\nexport function noteFromPitch(frequency) {\n    let noteNum = 12 * (Math.log(frequency / 440) / Math.log(2));\n    return Math.round(noteNum) + 69;\n}\nexport function frequencyFromNoteNumber(note) {\n    return 440 * Math.pow(2, (note - 69) / 12);\n}\nexport function centsOffFromPitch(frequency, note) {\n    return Math.floor(1200 * Math.log(frequency / frequencyFromNoteNumber(note)) / Math.log(2));\n}\nexport function colorFromNote(note) {\n    let octave = Math.floor(note / 12) - 1;\n    let idx = Math.min(octave, OCTAVE_COLORS.length - 1);\n    idx = Math.max(0, idx);\n    return OCTAVE_COLORS[idx];\n}\n","import { scaleLinear } from 'd3-scale';\nimport { NOTE_STRINGS } from '../constants';\nimport { noteFromPitch, colorFromNote, centsOffFromPitch } from '../utils';\nclass PitchDisplay {\n    constructor(container, timeSpan = 15000, timeOffset = 7000) {\n        this.frequencies = [];\n        this.background = '#efefef';\n        this.highlight = '#888888';\n        this.container = container;\n        this.container.style.position = \"relative\";\n        const canvasStyle = \"position: absolute; width: 100%; height: 100%;\";\n        this.bgCanvas = document.createElement(\"canvas\");\n        this.bgCanvas.setAttribute(\"style\", canvasStyle);\n        this.bgContext = this.bgCanvas.getContext('2d');\n        this.noteCanvas = document.createElement(\"canvas\");\n        this.noteCanvas.setAttribute(\"style\", canvasStyle);\n        this.noteContext = this.noteCanvas.getContext('2d');\n        this.container.appendChild(this.bgCanvas);\n        this.container.appendChild(this.noteCanvas);\n        this.timeSpan = timeSpan;\n        this.timeOffset = timeOffset;\n        this.resize();\n    }\n    resize() {\n        let w = this.container.clientWidth;\n        let h = this.container.clientHeight;\n        this.bgCanvas.width = w;\n        this.bgCanvas.height = h;\n        this.noteCanvas.width = w;\n        this.noteCanvas.height = h;\n        this.scaleX = scaleLinear()\n            .domain([-this.timeOffset, -this.timeOffset + this.timeSpan])\n            .range([0, w]);\n        let margin = h / (NOTE_STRINGS.length + 1);\n        this.scaleY = scaleLinear()\n            .domain([0, NOTE_STRINGS.length - 1])\n            .range([h - margin, margin]);\n        this.render();\n    }\n    pushFrequency(frequency) {\n        this.frequencies.push(frequency);\n    }\n    cleanupFrequencies() {\n        // Throw away the frequencies that are out of the current display window\n        this.frequencies = this.frequencies.filter((val) => this.now - val.time < this.timeOffset);\n    }\n    render(full = true) {\n        this.now = (new Date()).getTime();\n        this.cleanupFrequencies();\n        if (full) {\n            this.drawBackground();\n        }\n        this.drawNotes();\n    }\n    setBackgroundColor(color) {\n        this.background = color;\n        this.drawBackground();\n    }\n    setHighlightColor(color) {\n        this.highlight = color;\n        this.drawBackground();\n    }\n    drawBackground() {\n        let w = this.bgCanvas.width;\n        let h = this.bgCanvas.height;\n        this.bgContext.fillStyle = this.background;\n        this.bgContext.clearRect(0, 0, w, h);\n        this.bgContext.fillRect(0, 0, w, h);\n        for (let i = 0; i < NOTE_STRINGS.length; ++i) {\n            let y = this.scaleY(i);\n            this.bgContext.fillStyle = this.highlight + '55';\n            this.bgContext.fillRect(0, y, w, 1);\n            this.bgContext.fillStyle = this.highlight;\n            this.bgContext.font = '14px Sans';\n            this.bgContext.fillText(NOTE_STRINGS[i], this.scaleX(0) + 20, y - 2);\n            this.bgContext.fillText(NOTE_STRINGS[i], 20, y - 2);\n        }\n        this.bgContext.fillStyle = this.highlight + '55';\n        this.bgContext.fillRect(this.scaleX(0), 0, 1, h);\n    }\n    drawNotes() {\n        let w = this.noteCanvas.width;\n        let h = this.noteCanvas.height;\n        this.noteContext.clearRect(0, 0, w, h);\n        this.noteContext.beginPath();\n        this.noteContext.strokeStyle = 'rgba(0, 0, 0, 0.1)';\n        // Calculate notes and colors from frequencies\n        const notes = [];\n        for (let frequency of this.frequencies) {\n            let t = frequency.time;\n            let f = frequency.frequency;\n            let c = frequency.clarity;\n            let note = noteFromPitch(f);\n            let centsOff = centsOffFromPitch(f, note);\n            let x = this.scaleX(t - this.now);\n            let y = this.scaleY(note % 12 + centsOff / 100);\n            let color = colorFromNote(note);\n            notes.push({\n                time: t,\n                x,\n                y,\n                clarity: c,\n                color\n            });\n        }\n        // Draw lines\n        const timeCutoff = 500;\n        this.noteContext.beginPath();\n        for (let i = 1; i < notes.length; ++i) {\n            const { x, y, time } = notes[i];\n            const prevTime = notes[i - 1].time;\n            if (time - prevTime > timeCutoff) {\n                this.noteContext.stroke();\n                this.noteContext.beginPath();\n                this.noteContext.moveTo(x, y);\n            }\n            else {\n                this.noteContext.lineTo(x, y);\n            }\n        }\n        this.noteContext.stroke();\n        // Draw circles\n        for (let note of notes) {\n            const { x, y, clarity, color } = note;\n            this.noteContext.fillStyle = `rgba(${color[0]}, ${color[1]}, ${color[2]}, ${clarity * 0.5})`;\n            this.noteContext.beginPath();\n            this.noteContext.arc(x, y, 3, 0, Math.PI * 2);\n            this.noteContext.fill();\n        }\n    }\n}\nexport { PitchDisplay };\n","import React, { Component } from 'react';\n\nimport { PitchDisplay } from 'pitch-display';\n\nimport { BACKGROUND } from '../../constants/colors';\n\nexport interface PitchProps {\n  freq: number | null;\n  clarity: number | null;\n}\n\nclass PitchComponent extends Component<PitchProps> {\n  displayElement = React.createRef<HTMLDivElement>();\n  pitchDisplay?: PitchDisplay;\n  lastRender: number = 0;\n  continuousUpdate: boolean = true;\n\n  componentDidMount() {\n    this.pitchDisplay = new PitchDisplay(\n      this.displayElement.current!,\n      6000,\n      5000\n    );\n    this.pitchDisplay.setBackgroundColor(BACKGROUND);\n\n    // We want to ensure `pitchDisplay` updates at regular\n    // time intervals even if the note has not changed (so\n    // that the display continues scrolling)\n    const startRender = () => {\n      this.updatePitch();\n      if (this.continuousUpdate) {\n        requestAnimationFrame(startRender);\n      }\n    };\n    startRender();\n    window.addEventListener('resize', this.onResize);\n  }\n\n  componentWillUnmount() {\n    this.continuousUpdate = false;\n    window.removeEventListener('resize', this.onResize);\n  }\n\n  onResize = () => {\n    if (this.pitchDisplay) {\n      this.pitchDisplay.resize();\n    }\n  };\n\n  updatePitch() {\n    const time = new Date().getTime();\n    if (time - this.lastRender < 17) {\n      // We don't want to render faster than 60fps\n      return;\n    }\n    if (!this.pitchDisplay) {\n      return;\n    }\n    const { freq, clarity } = this.props;\n    if (freq && freq > 0) {\n      this.pitchDisplay.pushFrequency({\n        frequency: freq,\n        clarity: clarity || 0,\n        time,\n      });\n    }\n    this.lastRender = time;\n    this.pitchDisplay.render(false);\n  }\n\n  render() {\n    this.updatePitch();\n    return (\n      <React.Fragment>\n        <div\n          className=\"full\"\n          style={{ position: 'relative' }}\n          ref={this.displayElement}\n        />\n      </React.Fragment>\n    );\n  }\n}\n\nexport default PitchComponent;\n","export const BACKGROUND = '#F5F5F5';\n\nexport const PRIMARY = '#3f51b5';\nexport const PRIMARY_LIGHT = '#757de8';\nexport const PRIMARY_DARK = '#002984';\nexport const PRIMARY_TEXT = '#ffffff';\n\nexport const SECONDARY = '#9c27b0';\nexport const SECONDARY_LIGHT = '#d05ce3';\nexport const SECONDARY_DARK = '#6a0080';\nexport const SECONDARY_TEXT = '#ffffff';\n","import { Connection } from 'post-me';\nimport React from 'react';\nimport { WorkerMethods } from '../../../worker/types';\n\ninterface PitchSetup {\n  analyser?: AnalyserNode;\n  audioContext?: AudioContext;\n  buffer?: Float32Array;\n}\ninterface PitchProps {\n  stream: MediaStream;\n  workerConnection: Connection<{}, WorkerMethods, {}>;\n  detectorName: 'autocorrelation' | 'mcleod';\n  windowSize: number;\n  powerThreshold: number;\n  clarityThreshold: number;\n  enabled: boolean;\n  pitchRenderer: React.ComponentType<{\n    freq: number | null;\n    clarity: number | null;\n  }>;\n}\n\n/**\n * While `enabled` is truthy, get the pitch from the input source,\n * and pass its frequency and clarity to `pitchRenderer`.\n *\n * `pitchRenderer` should be a react component that accepts `freq` and `clarity`\n * props.\n *\n * @export\n * @param {PitchProps} {\n *   stream,\n *   detectorName,\n *   workerConnection,\n *   windowSize,\n *   powerThreshold,\n *   clarityThreshold,\n *   enabled,\n *   pitchRenderer,\n * }\n * @returns\n */\nexport function PitchMonitor({\n  stream,\n  detectorName,\n  workerConnection,\n  windowSize,\n  powerThreshold,\n  clarityThreshold,\n  enabled,\n  pitchRenderer,\n}: PitchProps) {\n  const [freq, setFreq] = React.useState<number | null>(null);\n  const [clarity, setClarity] = React.useState<number | null>(null);\n  const pendingRef = React.useRef(false);\n  const pitchSetupRef = React.useRef<PitchSetup>({});\n\n  // Gets called first-thing whenever this component's props change.\n  const setupConnection = React.useCallback(async () => {\n    await workerConnection\n      .remoteHandle()\n      .call('createDetector', detectorName, windowSize, windowSize / 2);\n    const pitchSetup = pitchSetupRef.current;\n    pitchSetup.buffer = new Float32Array(windowSize);\n    pitchSetup.audioContext = new AudioContext();\n    // Create an AudioNode from the stream.\n    const mediaStreamSource = pitchSetup.audioContext.createMediaStreamSource(\n      stream\n    );\n    // Connect it to the destination.\n    pitchSetup.analyser = pitchSetup.audioContext.createAnalyser();\n    pitchSetup.analyser.fftSize = windowSize;\n    mediaStreamSource.connect(pitchSetup.analyser);\n  }, [pitchSetupRef, windowSize, detectorName, stream, workerConnection]);\n\n  // Find the current pitch/clarity and save it in `freq`/`clarity`.\n  const updatePitch = React.useCallback(async () => {\n    if (!pendingRef.current) {\n      pendingRef.current = true;\n\n      const pitchSetup = pitchSetupRef.current;\n      const { analyser, buffer, audioContext } = pitchSetup;\n      if (!analyser || !buffer || !audioContext) {\n        console.warn(\n          'Trying to update the pitch, but missing an analyser/buffer/audioContext'\n        );\n        return;\n      }\n      analyser.getFloatTimeDomainData(buffer);\n      const result = await workerConnection\n        .remoteHandle()\n        .call(\n          'getPitch',\n          buffer,\n          audioContext.sampleRate,\n          powerThreshold,\n          clarityThreshold\n        );\n      const frequency = result[0];\n      const clarity = result[1];\n      if (frequency > 0) {\n        setFreq(frequency);\n        setClarity(clarity);\n      } else {\n        setFreq(null);\n        setClarity(null);\n      }\n\n      pendingRef.current = false;\n    }\n  }, [\n    pendingRef,\n    pitchSetupRef,\n    setFreq,\n    setClarity,\n    powerThreshold,\n    clarityThreshold,\n    workerConnection,\n  ]);\n\n  // This function only gets called when the dependencies update, and it automatically\n  // cleans up when it is called subsequent times. It starts an endless loop\n  // of computing the current pitch.\n  React.useEffect(() => {\n    if (!enabled) {\n      // This function runs whenever the state of `enabled` changes.\n      // When this function is re-run, it automatically cancels the\n      // the audio monitoring, so all we need to do is return here.\n      return;\n    }\n    console.log('Starting audio monitoring.');\n    const escape = { cancelRender: false };\n    function renderFrame() {\n      if (escape.cancelRender) {\n        return;\n      }\n      requestAnimationFrame(renderFrame);\n      updatePitch();\n    }\n    (async () => {\n      await setupConnection();\n      renderFrame();\n    })();\n\n    return () => {\n      console.log('Stopping audio monitoring.');\n      escape.cancelRender = true;\n    };\n  }, [setupConnection, updatePitch, enabled]);\n\n  const PitchRenderer = pitchRenderer;\n  return <PitchRenderer freq={freq} clarity={clarity} />;\n}\n","import { Note, NOTE_SYMBOLS_SHARP } from './circle-chat';\n\nexport function freqToNote(freq: number): { note: Note; octave: number } {\n  const notes = Object.keys(NOTE_SYMBOLS_SHARP) as Note[];\n  const logNote = Math.log2(freq) - LOG_A;\n  // LOG_A is the log of A_4\n  const octave = Math.floor(logNote) + 4;\n  const rot = (((logNote - 0.25) % 1) + 1) % 1;\n  for (let i = 0; i < 12; i++) {\n    const low = i / 12 - 1 / 24;\n    const hi = i / 12 + 1 / 24;\n    if (rot > low && rot <= hi) {\n      return { note: notes[i], octave };\n    }\n  }\n  return { note: 'C', octave };\n}\n\n// The log of A_4\nconst LOG_A = Math.log2(440);\n\n/**\n * Convert a frequency to an angle in radians. The frequency\n * of a \"C\" is at the top of the circle.\n *\n * @export\n * @param {number} freq\n * @returns {number}\n */\nexport function freqToAngle(freq: number): number {\n  // We subtract 0.5, because A is halfway around the circle chart from 0 deg.\n  return ((((Math.log2(freq) - LOG_A - 0.5) % 1) + 1) % 1) * Math.PI * 2;\n}\n\n/**\n * Computes the inner and outer radius for the circle chart\n * based on the available size.\n *\n * @param {number} w\n * @param {number} h\n * @returns\n */\nexport function computeInnerAndOuterRadius(w: number, h: number) {\n  const outerR = Math.min(w, h) / 3;\n  const innerR = outerR * 0.6;\n  return { innerR, outerR };\n}\n\n/**\n * Compute the offset from the center of a circle of radius `r` that a box\n * of width/height `w`/`h` needs to have to be tangent to the circle.\n *\n * @param {number} angle - angle in which to compute the displacement\n * @param {number} r - radius of the circle\n * @param {number} w - width of the box\n * @param {number} h - height of the box\n * @returns {[number, number]} - displacement of the lower-left corner of the box to be tangent\n */\nexport function radialBoxLayoutOffsets(\n  angle: number,\n  r: number,\n  w: number,\n  h: number\n): [number, number] {\n  angle = ((angle % (2 * Math.PI)) + 2 * Math.PI) % (2 * Math.PI);\n\n  // This code was ported from Python. It's just easier to\n  // rename the math functions.\n  const pi = Math.PI;\n  const tan = Math.tan;\n  const arctan = Math.atan;\n  const sqrt = Math.sqrt;\n  const sin = Math.sin;\n  const cos = Math.cos;\n\n  let [outx, outy] = [0, 0];\n\n  if (r === 0) {\n    return [outx, outy];\n  }\n\n  const criticalrange1 = arctan(w / 2.0 / (r + h / 2.0));\n  const criticalrange2 = arctan(w / 2.0 / (r + h / 2.0));\n\n  // Edge is touching\n  if (angle < 0 + criticalrange1 || angle > 2 * pi - criticalrange1) {\n    outx = r;\n    outy = -(r + w / 2) * tan(angle) - h / 2.0;\n  } else if (angle > pi - criticalrange1 && angle < pi + criticalrange1) {\n    outx = -r - w;\n    outy = -(r + w / 2) * tan(pi - angle) - h / 2.0;\n  } else if (\n    angle > pi / 2 - criticalrange2 &&\n    angle < pi / 2 + criticalrange2\n  ) {\n    outx =\n      sqrt((w * w) / 4.0 + (r + h / 2.0) * (r + h / 2.0)) *\n        sin(pi / 2.0 - angle) -\n      w / 2.0;\n    outy = -(r + h);\n  } else if (\n    angle > (pi * 3) / 2 - criticalrange2 &&\n    angle < (pi * 3) / 2 + criticalrange2\n  ) {\n    outx =\n      sqrt((w * w) / 4.0 + (r + h / 2.0) * (r + h / 2.0)) *\n        sin(pi / 2 - angle) -\n      w / 2;\n    outy = r;\n  }\n  // Corner is touching\n  else if (angle >= 0 + criticalrange1 && angle <= pi / 2 - criticalrange2) {\n    const a = sqrt((w * w) / 4.0 + (h * h) / 4.0);\n    const b = r;\n    const B = angle - arctan(h / w);\n    const c = sqrt(b * b + (cos(B) * cos(B) - 1) * a * a) + cos(B) * a;\n    outx = c * cos(angle) - w / 2.0;\n    outy = -(c * sin(angle) + h / 2.0);\n  } else if (angle >= pi / 2 + criticalrange2 && angle <= pi - criticalrange1) {\n    //adjust angle so we can pretend we're in the first quadrant\n    angle = pi - angle;\n    const a = sqrt((w * w) / 4.0 + (h * h) / 4.0);\n    const b = r;\n    const B = angle - arctan(h / w);\n    const c = sqrt(b * b + (cos(B) * cos(B) - 1) * a * a) + cos(B) * a;\n    outx = -(c * cos(angle) - w / 2) - w;\n    outy = -(c * sin(angle) + h / 2);\n  } else if (\n    angle >= pi + criticalrange1 &&\n    angle <= (pi * 3) / 2 - criticalrange2\n  ) {\n    // adjust angle so we can pretend we're in the first quadrant\n    angle -= pi;\n    const a = sqrt((w * w) / 4 + (h * h) / 4);\n    const b = r;\n    const B = angle - arctan(h / w);\n    const c = sqrt(b * b + (cos(B) * cos(B) - 1) * a * a) + cos(B) * a;\n    outx = -c * cos(angle) - w / 2;\n    outy = c * sin(angle) - h / 2;\n  } else if (\n    angle >= (pi * 3) / 2 + criticalrange2 &&\n    angle <= 2 * pi - criticalrange1\n  ) {\n    // adjust angle so we can pretend we're in the first quadrant\n    angle = 2 * pi - angle;\n    const a = sqrt((w * w) / 4 + (h * h) / 4);\n    const b = r;\n    const B = angle - arctan(h / w);\n    const c = sqrt(b * b + (cos(B) * cos(B) - 1) * a * a) + cos(B) * a;\n    outx = c * cos(angle) - w / 2;\n    outy = c * sin(angle) - h / 2;\n  }\n\n  return [outx, outy];\n}\n","import React from 'react';\nimport {\n  computeInnerAndOuterRadius,\n  freqToAngle,\n  freqToNote,\n  radialBoxLayoutOffsets,\n} from './utils';\n\nexport type Note =\n  | 'C'\n  | 'Db'\n  | 'D'\n  | 'Eb'\n  | 'E'\n  | 'F'\n  | 'Gb'\n  | 'G'\n  | 'Ab'\n  | 'A'\n  | 'Bb'\n  | 'B';\n\nexport const NOTE_SYMBOLS_SHARP: { [key in Note]: string } = {\n  C: 'C',\n  Db: 'C♯',\n  D: 'D',\n  Eb: 'D♯',\n  E: 'E',\n  F: 'F',\n  Gb: 'F♯',\n  G: 'G',\n  Ab: 'G♯',\n  A: 'A',\n  Bb: 'A♯',\n  B: 'B',\n};\nexport const NOTE_SYMBOLS_FLAT: { [key in Note]: string } = {\n  C: 'C',\n  Db: 'D♭',\n  D: 'D',\n  Eb: 'E♭',\n  E: 'E',\n  F: 'F',\n  Gb: 'G♭',\n  G: 'G',\n  Ab: 'A♭',\n  A: 'A',\n  Bb: 'B♭',\n  B: 'B',\n};\n\nexport function drawCircleChartBackground(\n  ctx: CanvasRenderingContext2D,\n  [w, h]: [number, number],\n  options: {\n    innerR?: number;\n    outerR?: number;\n  } = {}\n) {\n  const offsetAngle = 0;\n  const [cX, cY] = [w / 2, h / 2];\n  const outerR = options.outerR ?? Math.min(w, h) / 3;\n  const innerR = options.innerR ?? outerR * 0.6;\n\n  const ring = new Path2D();\n  ring.arc(cX, cY, outerR, 0, 2 * Math.PI);\n  // If we don't move to the start of the next arc, there\n  // will be a line connecting them.\n  ring.moveTo(cX + innerR, cY);\n  ring.arc(cX, cY, innerR, 0, 2 * Math.PI);\n  ctx.fillStyle = 'rgb(204,204,240)';\n  ctx.fill(ring, 'evenodd');\n\n  ctx.strokeStyle = 'rgb(110,102,102)';\n\n  // draw some ticks\n  const ticks = new Path2D();\n  for (let i = 0; i < 5 * 12; i++) {\n    const angle = (i / (5 * 12)) * 2 * Math.PI - offsetAngle;\n    let tickLen = 0.5;\n    if (i % 5 === 0) {\n      // Every fifth tick is long\n      tickLen = 1.0;\n    }\n    const vecX = Math.cos(angle);\n    const vecY = Math.sin(angle);\n    ticks.moveTo(vecX * outerR + cX, vecY * outerR + cY);\n    ticks.lineTo(\n      vecX * (1 - 0.08 * tickLen) * outerR + cX,\n      vecY * (1 - 0.08 * tickLen) * outerR + cY\n    );\n  }\n  ctx.lineWidth = 2;\n  ctx.stroke(ticks);\n\n  ctx.lineWidth = 1;\n  ctx.stroke(ring);\n\n  return { innerR, outerR };\n}\n\nfunction drawCircleChartArrow(\n  ctx: CanvasRenderingContext2D,\n  [w, h]: [number, number],\n  options: {\n    angle: number;\n    opacity: number;\n    innerR: number;\n    outerR: number;\n  }\n) {\n  const { angle, opacity, innerR, outerR } = options;\n  const [vec_x, vec_y] = [Math.cos(angle), Math.sin(angle)];\n  // Compute the normal vector\n  const [nvec_x, nvec_y] = [-vec_y, vec_x];\n\n  ctx.moveTo(\n    vec_x * innerR + 3 * nvec_x + w / 2,\n    -(vec_y * innerR + 3 * nvec_y) + h / 2\n  );\n  ctx.lineTo(\n    vec_x * innerR - 3 * nvec_x + w / 2,\n    -(vec_y * innerR - 3 * nvec_y) + h / 2\n  );\n  ctx.lineTo(vec_x * outerR + w / 2, -(vec_y * outerR) + h / 2);\n\n  ctx.fillStyle = `rgba(0,128,204,${opacity})`;\n  ctx.fill();\n  ctx.strokeStyle = `rgba(0,77,204,${opacity})`;\n  ctx.lineJoin = 'bevel';\n  ctx.stroke();\n}\n\nfunction Frequency({\n  hz,\n  noteFormat,\n}: {\n  hz: number;\n  noteFormat: 'sharp' | 'flat';\n}) {\n  const noteSymbols =\n    noteFormat === 'sharp' ? NOTE_SYMBOLS_SHARP : NOTE_SYMBOLS_FLAT;\n  const { note, octave } = freqToNote(hz);\n  return (\n    <div className=\"freq-container\">\n      <span className=\"freq-note\">\n        {noteSymbols[note]}\n        <span className=\"freq-octave\">{octave}</span>\n      </span>\n      <span className=\"freq-hz\">{Math.round(hz)} Hz</span>\n    </div>\n  );\n}\n\nconst CircleChartBackground = React.memo(function CircleChartBackground({\n  w,\n  h,\n  noteFormat = 'sharp',\n}: {\n  w: number;\n  h: number;\n  noteFormat?: 'sharp' | 'flat';\n}) {\n  const canvas = React.useRef<HTMLCanvasElement>(null);\n  // The note labels are rendered in divs so we can use CSS to style them.\n  // We need to store refs to all these divs so we can dynamically compute their\n  // sizes.\n  const noteRefs = React.useRef<React.RefObject<HTMLDivElement>[]>([\n    { current: null },\n    { current: null },\n    { current: null },\n    { current: null },\n    { current: null },\n    { current: null },\n    { current: null },\n    { current: null },\n    { current: null },\n    { current: null },\n    { current: null },\n    { current: null },\n  ]);\n  const offsetAngle = 0;\n  const [cX, cY] = [w / 2, h / 2];\n  const outerR = Math.min(w, h) / 3;\n  const innerR = outerR * 0.6;\n\n  const noteSymbols =\n    noteFormat === 'sharp' ? NOTE_SYMBOLS_SHARP : NOTE_SYMBOLS_FLAT;\n  const notes = Object.keys(noteSymbols) as Note[];\n\n  React.useEffect(() => {\n    const ctx = canvas.current?.getContext('2d');\n    if (!ctx) {\n      return;\n    }\n\n    drawCircleChartBackground(ctx, [w, h], { innerR, outerR });\n    // Position all the labels\n    for (let i = 0; i < 12; i++) {\n      const angle = (-i / 12.0) * 2 * Math.PI + Math.PI / 2 + offsetAngle;\n      const ref = noteRefs.current[i];\n      if (!ref.current) {\n        continue;\n      }\n      const div = ref.current;\n      const { width: divW, height: divH } = div.getBoundingClientRect();\n      const [ox, oy] = radialBoxLayoutOffsets(angle, outerR + 4, divW, divH);\n      div.style.left = `${ox + cX}px`;\n      div.style.top = `${oy + cY}px`;\n    }\n  }, [w, h, noteFormat, cX, cY, innerR, outerR, offsetAngle]);\n\n  return (\n    <React.Fragment>\n      <canvas width={w} height={h} ref={canvas} className=\"freq-background\" />\n      {noteRefs.current.map((ref, i) => (\n        <div key={i} ref={ref} className=\"freq-note-label\">\n          {noteSymbols[notes[i]]}\n        </div>\n      ))}\n    </React.Fragment>\n  );\n});\n\nexport function CircleChart({\n  freq = 440,\n  clarity = 0,\n}: {\n  freq: number | null;\n  clarity: number | null;\n}) {\n  const [w, setW] = React.useState(400);\n  const [h, setH] = React.useState(400);\n  const surroundingDivRef = React.useRef<HTMLDivElement>(null);\n  const canvasPointerRef = React.useRef<HTMLCanvasElement>(null);\n  const { innerR, outerR } = computeInnerAndOuterRadius(w, h);\n  const angle = freqToAngle(freq || 440);\n\n  // Track resize changes and make sure to resize the circle chart accordingly\n  React.useLayoutEffect(() => {\n    function handleResize() {\n      const div = surroundingDivRef.current;\n      if (!div) {\n        return;\n      }\n      const { width, height } = div.getBoundingClientRect();\n      setW(width);\n      setH(height);\n    }\n    // Run the resizer once when the component mounts.\n    handleResize();\n\n    window.addEventListener('resize', handleResize);\n    return () => {\n      window.removeEventListener('resize', handleResize);\n    };\n  }, [setW, setH, surroundingDivRef]);\n\n  React.useEffect(() => {\n    if (!canvasPointerRef.current) {\n      return;\n    }\n    const pointerContext = canvasPointerRef.current.getContext('2d');\n    if (!pointerContext) {\n      return;\n    }\n\n    //Our draw come here\n    drawCircleChartArrow(pointerContext, [w, h], {\n      angle: 0,\n      opacity: 0.8,\n      innerR,\n      outerR,\n    });\n  }, [w, h, innerR, outerR]);\n\n  return (\n    <div ref={surroundingDivRef} className=\"freq-surround\">\n      <CircleChartBackground w={w} h={h} noteFormat=\"sharp\" />\n      {freq && <Frequency hz={freq || 440} noteFormat=\"sharp\" />}\n      <canvas\n        className=\"freq-pointer\"\n        width={w}\n        height={h}\n        ref={canvasPointerRef}\n        style={{\n          transformOrigin: 'center',\n          transform: `rotate(${angle}rad)`,\n          visibility: freq ? 'visible' : 'hidden',\n        }}\n      />\n    </div>\n  );\n}\n","import {\n  action,\n  Action,\n  createStore,\n  createTypedHooks,\n  thunk,\n  Thunk,\n} from 'easy-peasy';\nimport { Connection, ParentHandshake, WorkerMessenger } from 'post-me';\n\ntype Detector = 'mcleod' | 'autocorrelation';\ntype DisplayType = 'chart' | 'circle';\n\ninterface StoreModel {\n  windowSize: number;\n  setWindowSize: Action<StoreModel, number>;\n\n  detectorName: Detector;\n  setDetectorName: Action<StoreModel, Detector>;\n\n  displayType: DisplayType;\n  setDisplayType: Action<StoreModel, DisplayType>;\n\n  clarityThreshold: number;\n  setClarityThreshold: Action<StoreModel, number>;\n\n  enabled: boolean;\n  setEnabled: Action<StoreModel, boolean>;\n\n  stream: MediaStream | null | undefined;\n  audioOptions: MediaStreamConstraints;\n  setStream: Action<StoreModel, MediaStream | null>;\n  loading: boolean;\n  setLoading: Action<StoreModel, boolean>;\n  loaded: boolean;\n  setLoaded: Action<StoreModel, boolean>;\n  initializeStream: Thunk<StoreModel, void>;\n  stopStream: Thunk<StoreModel, void>;\n\n  workerConnection: Connection | null | undefined;\n  setWorkerConnection: Action<StoreModel, Connection | null>;\n  initializeWorker: Thunk<StoreModel, void>;\n}\n\nexport const store = createStore<StoreModel>({\n  // Default values\n  windowSize: 1024,\n  detectorName: 'mcleod',\n  displayType: 'chart',\n  clarityThreshold: 0.5,\n  enabled: false,\n  loading: false,\n  loaded: false,\n  stream: null,\n  audioOptions: { audio: { echoCancellation: true, autoGainControl: true } },\n  workerConnection: null,\n\n  setWindowSize: action((state, payload) => {\n    state.windowSize = payload;\n  }),\n  setDetectorName: action((state, payload) => {\n    state.detectorName = payload;\n  }),\n  setDisplayType: action((state, payload) => {\n    state.displayType = payload;\n  }),\n  setClarityThreshold: action((state, payload) => {\n    state.clarityThreshold = payload;\n  }),\n  setEnabled: action((state, payload) => {\n    state.enabled = payload;\n  }),\n  setStream: action((state, payload) => {\n    state.stream = payload;\n  }),\n  setLoading: action((state, payload) => {\n    state.loading = payload;\n  }),\n  setLoaded: action((state, payload) => {\n    state.loaded = payload;\n  }),\n  setWorkerConnection: action((state, payload) => {\n    state.workerConnection = payload;\n  }),\n  initializeStream: thunk(async (actions, payload, { getState }) => {\n    const state = getState();\n    const options = state.audioOptions;\n\n    actions.setLoading(true);\n    try {\n      const stream = await navigator.mediaDevices.getUserMedia(options);\n      actions.setStream(stream);\n      actions.setLoading(false);\n      actions.setLoaded(true);\n    } catch (e) {\n      console.error(e);\n      actions.setStream(null);\n      actions.setLoading(false);\n      actions.setLoaded(false);\n    }\n  }),\n  stopStream: thunk(async (actions, payload, { getState }) => {\n    const stream = getState().stream;\n\n    if (stream) {\n      for (const track of stream.getTracks()) {\n        track.stop();\n      }\n    }\n\n    actions.setStream(null);\n    actions.setLoading(false);\n    actions.setLoaded(false);\n  }),\n  initializeWorker: thunk(async (actions) => {\n    const worker = new Worker(\n      `${process.env.PUBLIC_URL}/pitch-detection/worker.js`\n    );\n\n    const messenger = new WorkerMessenger({ worker });\n\n    try {\n      const connection = await ParentHandshake(messenger, {}, 5, 1000);\n      actions.setWorkerConnection(connection);\n    } catch (e) {\n      console.error('Failed to connect to worker', e);\n      actions.setWorkerConnection(null);\n    }\n  }),\n});\n\n// Create a version of the standard hooks that always references our `StoreModel` type\nconst typedHooks = createTypedHooks<StoreModel>();\n\nexport const useStoreActions = typedHooks.useStoreActions;\nexport const useStoreDispatch = typedHooks.useStoreDispatch;\nexport const useStoreState = typedHooks.useStoreState;\n","import React from 'react';\n\nimport './side-nav.css';\nimport 'hamburgers/dist/hamburgers.min.css';\n\nconst SideNavContext = React.createContext({\n  expanded: false,\n  toggleExpanded: () => {},\n});\n\nfunction _SideNav({\n  expanded: _expanded,\n  onToggle,\n  children,\n}: {\n  expanded?: boolean;\n  onToggle?: Function;\n  children?: React.ReactNode;\n}) {\n  // We use built-in state unless a managed state is passed in.\n  let [expanded, setExpanded] = React.useState(_expanded || false);\n  if (_expanded != null) {\n    expanded = _expanded;\n  }\n  function toggleExpanded() {\n    setExpanded(!expanded);\n    if (onToggle) {\n      onToggle(!expanded);\n    }\n  }\n\n  return (\n    <SideNavContext.Provider value={{ expanded, toggleExpanded }}>\n      <nav className={`sidenav ${expanded ? 'expanded' : ''}`}>{children}</nav>\n    </SideNavContext.Provider>\n  );\n}\n\nexport function Toggle() {\n  const { expanded, toggleExpanded } = React.useContext(SideNavContext);\n  return (\n    <div className=\"sidenav-toggle\">\n      <button\n        className={`hamburger hamburger--squeeze ${\n          expanded ? 'is-active' : ''\n        }`}\n        type=\"button\"\n        aria-label=\"Menu\"\n        aria-controls=\"navigation\"\n        onClick={toggleExpanded}\n      >\n        <span className=\"hamburger-box\">\n          <span className=\"hamburger-inner\"></span>\n        </span>\n      </button>\n    </div>\n  );\n}\n\nexport function Nav({ children }: { children: React.ReactNode }) {\n  return <div className=\"sidenav-nav\">{children}</div>;\n}\n\nexport function NavItem({\n  children,\n  ...rest\n}: { children: React.ReactNode } & React.HTMLAttributes<HTMLDivElement>) {\n  let { className, ..._rest } = rest;\n  className = 'sidenav-item ' + (className ? className : '');\n  return (\n    <div className={className} {..._rest}>\n      {children}\n    </div>\n  );\n}\n\nexport function NavIcon({ children }: { children: React.ReactNode }) {\n  return <button className=\"sidenav-icon\">{children}</button>;\n}\nexport function NavText({ children }: { children: React.ReactNode }) {\n  return <div className=\"sidenav-text\">{children}</div>;\n}\nexport function NavExtra({ children }: { children: React.ReactNode }) {\n  return <div className=\"sidenav-extra\">{children}</div>;\n}\n\nexport const SideNav = Object.assign(_SideNav, {\n  Nav,\n  NavItem,\n  NavIcon,\n  NavText,\n  NavExtra,\n});\n","import React from 'react';\nimport { Dropdown, DropdownButton, Form } from 'react-bootstrap';\nimport { useStoreActions, useStoreState } from '../../model';\n\nexport function Select({\n  selected: _selected,\n  onSelect: _onSelect,\n  choices,\n}: {\n  selected?: any;\n  onSelect?: Function;\n  choices: { value: any; desc: React.ReactNode }[];\n}) {\n  let [selected, setSelected] = React.useState(_selected);\n  if (_selected != null) {\n    selected = _selected;\n  }\n  const selectedIndex = Math.max(\n    choices.findIndex((item) => item.value === selected),\n    0\n  );\n\n  function onSelect(index: any) {\n    setSelected(choices[index].value);\n    if (_onSelect) {\n      _onSelect(choices[index].value);\n    }\n  }\n\n  return (\n    <DropdownButton\n      onSelect={onSelect}\n      title={choices[selectedIndex].desc}\n      variant=\"outline-light\"\n      as=\"span\"\n    >\n      {choices?.map(({ desc }, i) => (\n        <Dropdown.Item key={i} eventKey={'' + i}>\n          {desc}\n        </Dropdown.Item>\n      ))}\n    </DropdownButton>\n  );\n}\n\nexport function SelectWindowSize() {\n  const windowSize = useStoreState((state) => state.windowSize);\n  const setWindowSize = useStoreActions((actions) => actions.setWindowSize);\n  return (\n    <Select\n      selected={windowSize}\n      onSelect={setWindowSize}\n      choices={[\n        { value: 512, desc: '512 Samples' },\n        { value: 1024, desc: '1024 Samples' },\n        { value: 2048, desc: '2048 Samples' },\n        { value: 4096, desc: '4096 Samples' },\n      ]}\n    />\n  );\n}\n\nexport function SelectDetector() {\n  const detectorName = useStoreState((state) => state.detectorName);\n  const setDetectorName = useStoreActions((actions) => actions.setDetectorName);\n  return (\n    <Select\n      selected={detectorName}\n      onSelect={setDetectorName}\n      choices={[\n        { value: 'mcleod', desc: 'McLeod' },\n        { value: 'autocorrelation', desc: 'Autocorrelation' },\n      ]}\n    />\n  );\n}\n\nexport function SelectClarityThreshold() {\n  const clarityThreshold = useStoreState((state) => state.clarityThreshold);\n  const setClarityThreshold = useStoreActions(\n    (actions) => actions.setClarityThreshold\n  );\n\n  return (\n    <Form>\n      <Form.Group>\n        <Form.Control\n          type=\"range\"\n          value={clarityThreshold}\n          min={0.0}\n          max={1.0}\n          step={0.01}\n          onChange={(e) => setClarityThreshold(parseFloat(e.target.value))}\n        />\n      </Form.Group>\n    </Form>\n  );\n}\n\nexport function SelectDisplayType() {\n  const displayType = useStoreState((state) => state.displayType);\n  const setDisplayType = useStoreActions((actions) => actions.setDisplayType);\n\n  return (\n    <Select\n      selected={displayType}\n      onSelect={setDisplayType}\n      choices={[\n        { value: 'chart', desc: 'Linear Chart' },\n        { value: 'circle', desc: 'Circle Chart' },\n      ]}\n    />\n  );\n}\n","import React from 'react';\nimport { ListGroup, Navbar } from 'react-bootstrap';\nimport { Gear, Lightbulb, Play, Stop } from 'react-bootstrap-icons';\nimport { useStoreActions, useStoreState } from '../../model';\nimport {\n  NavIcon,\n  NavItem,\n  NavText,\n  NavExtra,\n  SideNav,\n  Toggle,\n} from '../side-nav/side-nav';\nimport {\n  SelectClarityThreshold,\n  SelectDetector,\n  SelectDisplayType,\n  SelectWindowSize,\n} from './options';\n\nexport function AppFrame({ children }: { children: React.ReactNode }) {\n  const [menuExpanded, setMenuExpanded] = React.useState(false);\n  const [running, setRunning] = React.useState(false);\n  const clarityThreshold = useStoreState((state) => state.clarityThreshold);\n\n  const { initializeStream, stopStream, setEnabled } = useStoreActions(\n    (actions) => actions\n  );\n\n  React.useEffect(() => {\n    if (running) {\n      (async () => {\n        await initializeStream();\n        setEnabled(true);\n        console.log('Stream Initialized');\n      })();\n    } else {\n      (async () => {\n        setEnabled(false);\n        await stopStream();\n        console.log('Stream Stopped');\n      })();\n    }\n\n    return stopStream;\n  }, [initializeStream, running, setEnabled, stopStream]);\n\n  return (\n    <React.Fragment>\n      <Navbar bg=\"primary\" variant=\"dark\">\n        <Navbar.Brand>Pitch Detector</Navbar.Brand>\n      </Navbar>\n      <div className=\"main-container\">\n        <SideNav expanded={menuExpanded} onToggle={setMenuExpanded}>\n          <Toggle />\n          <SideNav.Nav>\n            <NavItem\n              className={running ? 'active' : ''}\n              onClick={() => {\n                setRunning(!running);\n              }}\n            >\n              {running ? (\n                <React.Fragment>\n                  <NavIcon>\n                    <Stop size=\"20\" />\n                  </NavIcon>\n                  <NavText>Stop</NavText>\n                </React.Fragment>\n              ) : (\n                <React.Fragment>\n                  <NavIcon>\n                    <Play size=\"20\" />\n                  </NavIcon>\n                  <NavText>Start</NavText>\n                </React.Fragment>\n              )}\n            </NavItem>\n            <NavItem\n              onClick={() => {\n                setMenuExpanded(!menuExpanded);\n              }}\n            >\n              <NavIcon>\n                <Gear size=\"20\" />\n              </NavIcon>\n              <NavText>Settings</NavText>\n            </NavItem>\n            <NavExtra>\n              <ListGroup variant=\"flush\" color=\"primary\">\n                <ListGroup.Item>\n                  <div className=\"setting\">\n                    <span className=\"setting-desc\">Window Size</span>\n                    <SelectWindowSize />\n                  </div>\n                </ListGroup.Item>\n                <ListGroup.Item>\n                  <div className=\"setting\">\n                    <span className=\"setting-desc\">Detector</span>\n                    <SelectDetector />\n                  </div>\n                </ListGroup.Item>\n                <ListGroup.Item>\n                  <div className=\"setting\">\n                    <span className=\"setting-desc\">\n                      Clarity Threshold ({clarityThreshold})\n                    </span>\n                    <SelectClarityThreshold />\n                  </div>\n                </ListGroup.Item>\n                <ListGroup.Item>\n                  <div className=\"setting\">\n                    <span className=\"setting-desc\">Display Type</span>\n                  </div>\n                  <SelectDisplayType />\n                </ListGroup.Item>\n              </ListGroup>\n            </NavExtra>\n            <NavItem\n              className={'mt-auto' + (running ? '' : ' active')}\n              onClick={() => {\n                // The about screen automatically shows when the app is not running,\n                // so this is a shortcut to show the about screen\n                setRunning(false);\n              }}\n            >\n              <NavIcon>\n                <Lightbulb size=\"20\" />\n              </NavIcon>\n              <NavText>About</NavText>\n            </NavItem>\n          </SideNav.Nav>\n        </SideNav>\n\n        <main role=\"main\">{children}</main>\n      </div>\n    </React.Fragment>\n  );\n}\n","import React from 'react';\n\nexport function About() {\n  return (\n    <div className=\"container\" style={{ textAlign: 'center' }}>\n      <h2>Dhrupad Gurukul</h2>\n      <img \n        src={process.env.PUBLIC_URL + '/DhrupadGurukul.png'} \n        alt=\"Dhrupad Gurukul\" \n        style={{ maxWidth: '100%', height: 'auto' }}\n      />\n    </div>\n  );\n}\n","import React from 'react';\n\nimport PitchComponent from './components/pitch';\nimport { PitchMonitor } from './components/pitch/pitch-monitor';\nimport { CircleChart } from './components/circle-chart/circle-chat';\nimport { AppFrame } from './components/main/app-frame';\nimport { useStoreActions, useStoreState } from './model';\nimport { About } from './components/main/about';\n\nfunction App() {\n  const POWER_THRESHOLD = 0.15;\n\n  const detectorName = useStoreState((state) => state.detectorName);\n  const windowSize = useStoreState((state) => state.windowSize);\n  const clarityThreshold = useStoreState((state) => state.clarityThreshold);\n  const displayType = useStoreState((state) => state.displayType);\n  const enabled = useStoreState((state) => state.enabled);\n\n  const { loaded, stream, workerConnection } = useStoreState((state) => ({\n    loaded: state.loaded,\n    loading: state.loading,\n    stream: state.stream,\n    workerConnection: state.workerConnection,\n  }));\n\n  const { initializeWorker } = useStoreActions((actions) => actions);\n\n  React.useEffect(() => {\n    (async () => {\n      await initializeWorker();\n      console.log('Worker initialized');\n    })();\n  }, [initializeWorker]);\n\n  let mainDisplay = <About />;\n  if (loaded && stream && workerConnection) {\n    const pitchRenderer =\n      displayType === 'circle' ? CircleChart : PitchComponent;\n    mainDisplay = (\n      <PitchMonitor\n        stream={stream}\n        detectorName={detectorName}\n        workerConnection={workerConnection}\n        windowSize={windowSize}\n        powerThreshold={POWER_THRESHOLD}\n        clarityThreshold={clarityThreshold}\n        enabled={enabled}\n        pitchRenderer={pitchRenderer}\n      />\n    );\n  }\n\n  return <AppFrame>{mainDisplay}</AppFrame>;\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport { StoreProvider } from 'easy-peasy';\nimport { store } from './model';\n\nReactDOM.render(\n  <React.StrictMode>\n    <StoreProvider store={store}>\n      <App />\n    </StoreProvider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}